# NIST-CVE-Parser
Extractor de los CVE ordenados en función de su criticidad de la página del NIST

# Ejemplo de uso

1. Para la versión de Apache 9.0.37, se hace la búsqueda
https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe%3A2.3%3Aa%3Aapache%3Atomcat%3A9.0.37%3A*%3A*%3A*%3A*%3A*%3A*%3A*

2. Se abre la consola (F12) y se pega el script `parser.js`

```javascript
function getCVEs() {
  let cveElements = document.querySelectorAll('a[href^="/vuln/detail/CVE-"]');
  let cves = [];

  cveElements.forEach((element, index) => {
    let cveId = element.innerText;
    let cvss3Element = document.querySelector(`[data-testid="vuln-cvss3-link-${index}"]`);
    let cvss3Value = parseFloat(cvss3Element.innerText.split(' ')[0]);

    cves.push({
      cve: cveId,
      cvss3: cvss3Value
    });
  });

  return cves;
}

function sortByCVSS3(cves) {
  return cves.sort((a, b) => b.cvss3 - a.cvss3);
}

function getSortedCVEsAsString(sortedCVEs) {
  return sortedCVEs.map(cve => cve.cve).join(', ');
}

let cves = getCVEs();
let sortedCVEs = sortByCVSS3(cves);
let sortedCVEsAsString = getSortedCVEsAsString(sortedCVEs);

console.log(sortedCVEs);
console.log(sortedCVEsAsString);
```

3. Se obtendrá el listado ordenado de los CVE.

![image](https://user-images.githubusercontent.com/63324014/234251789-6e922047-50cd-4184-a1d1-099d1429401a.png)
