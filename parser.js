function getCVEs() {
  let cveElements = document.querySelectorAll('a[href^="/vuln/detail/CVE-"]');
  let cves = [];

  cveElements.forEach((element, index) => {
    let cveId = element.innerText;
    let cvss3Element = document.querySelector(`[data-testid="vuln-cvss3-link-${index}"]`);
    let cvss3Value = parseFloat(cvss3Element.innerText.split(' ')[0]);

    cves.push({
      cve: cveId,
      cvss3: cvss3Value
    });
  });

  return cves;
}

function sortByCVSS3(cves) {
  return cves.sort((a, b) => b.cvss3 - a.cvss3);
}

function getSortedCVEsAsString(sortedCVEs) {
  return sortedCVEs.map(cve => cve.cve).join(', ');
}

let cves = getCVEs();
let sortedCVEs = sortByCVSS3(cves);
let sortedCVEsAsString = getSortedCVEsAsString(sortedCVEs);

console.log(sortedCVEs);
console.log(sortedCVEsAsString);
